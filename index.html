<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Wildfire Risk Map</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.0/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css">
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web" rel="stylesheet">

    <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            margin: 0;
            background: #fff;
        }

        /* Map Title */
        #map-title {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255,255,255,0.9);
            padding: 12px 18px;
            border-radius: 6px;
            font-family: 'Titillium Web', sans-serif;
            font-size: 24px;
            font-weight: bold;
            box-shadow: 0 0 8px rgba(0,0,0,0.25);
            z-index: 1000;
        }

        /* Info Box */
         #info-box {
            position: absolute;
            top: 75px;   /* pushes it directly below title */
            left: 10px;
            width: 280px;
            background: rgba(255,255,255,0.9);
            padding: 12px 15px;
            border-radius: 8px;
            z-index: 1000;
            font-family: 'Arial', sans-serif;
            font-size: 15px;
            line-height: 1.4em;
            box-shadow: 0 0 10px rgba(0,0,0,0.25);
        }

        /* Legend */
        .legend {
            line-height: 40px;
            font-size: 16px;
            width: 220px;
            color: #333333;
            padding: 6px 8px;
            background: rgba(255,255,255,0.7);
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 5px;
            font-family: 'Titillium Web', sans-serif;
        }

        .legend i {
            width: 20px;
            height: 20px;
            float: left;
            margin-right: 8px;
            opacity: 0.9;
        }

        .legend p {
            font-size: 14px;
            line-height: 20px;
            margin: 0;
        }
    </style>

    <script src="https://unpkg.com/leaflet@1.7.0/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>

</head>
<body>

<div id="map-title">U.S. Wildfire Risk Map, 2025</div>

<div id="info-box">
    <b>About This Map</b><br>
    This map shows wildfire risk levels across U.S. counties, as well as 
    the locations of the 15 most devestating wildfire of the 2025 season. Higher risk counties are shown in warm colors, 
    while lower risk counties are in cooler colors. Clicking any county to see it's induvidal Wildfire risk rating, and clicking any wildfire icon will display more information about that wildfire. 

    A study from the Sierra Nevada Research Institute has projected that climate change has increased the number of wildfires in the US. Around 98% of the western US is at risk of increased wildfire risk from lightning strikes and fire friednly conditions. The increase in Wildfires caused by climate change has caused more then just ecological probelms for the US, and if proper measures aren't taken wildfires could become even more of an issue in the future. For more information about this increased risk of wildfires read the article writen by Eric Holthaus. 
    
     <a href="https://www.theguardian.com/us-news/2025/sep/06/climate-crisis-lightning-sparked-wildfires-increase" 
       target="_blank">
       Climate crisis will increase frequency wildfires
    </a>
</div>

<div id="map"></div>

<script>


var mymap = L.map('map', {
    center: [39.8283, -98.5795],
    zoom: 4,
    detectRetina: true
});

// Basemap
L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png')
    .addTo(mymap);



var wildfireColor = chroma('red').brighten(1).hex();

// Add icon style
$('head').append(`<style>
.marker-wildfire { 
    color: ${wildfireColor}; 
    font-size: 22px; 
    text-shadow: 0 0 3px #fff; 
}
</style>`);

var pointLayer = L.geoJson.ajax("assets/firepoints.geojson", {
    onEachFeature: function(feature, layer) {

        var name = feature.properties.name || "Unknown Name";
        var acres = feature.properties.acers || "Unknown Acres";
        var date = feature.properties.date || "Unknown Date";

        var popupContent = `
            <b>${name}</b><br>
            <b>Acres:</b> ${acres}<br>
            <b>Date:</b> ${date}
        `;

        layer.bindPopup(popupContent);
    },

    pointToLayer: function(feature, latlng) {
        return L.marker(latlng, {
            icon: L.divIcon({
                className: `fas fa-fire marker-wildfire`
            })
        });
    }
}).addTo(mymap);



// Warm cool scale
 var riskColors = {
        "Very High": "#800026",        // deep red
        "Relatively High": "#BD0026",  // red
        "Relatively Moderate": "#E6B800", // yellow
        "Relatively Low": "#82c4e8",   // light blue
        "Very Low": "#3182bd"          // strong blue
    };

function setRiskColor(value) {
    return riskColors[value] || "#999";
}

function riskStyle(feature) {
    return {
        fillColor: setRiskColor(feature.properties["risk_RISK_RATNG"]),
        fillOpacity: 0.60,
        weight: 1,
        opacity: 1,
        color: "#444"
    };
}

var polygonLayer = L.geoJson.ajax("assets/risk.geojson", {
    style: riskStyle,
    onEachFeature: function(feature, layer) {
        var rating = feature.properties["risk_RISK_RATNG"] || "Unknown";
        layer.bindPopup("<b>Risk Rating:</b> " + rating);
    }
}).addTo(mymap);



var legend = L.control({ position: 'topright' });

legend.onAdd = function () {
    var div = L.DomUtil.create('div', 'legend');

    div.innerHTML += '<b>Wildfire Risk</b><br />';

    var categories = [
        "Very High",
        "Relatively High",
        "Relatively Moderate",
        "Relatively Low",
        "Very Low"
    ];

    categories.forEach(function(cat) {
        div.innerHTML +=
            '<i style="background:' + riskColors[cat] + '; opacity:0.7"></i><p>' + cat + '</p>';
    });

    div.innerHTML += '<hr><b>Wildfire Points</b><br />';
    div.innerHTML += '<i class="fas fa-fire" style="color:' + wildfireColor + ';"></i><p>Wildfires</p>';

    return div;
};

legend.addTo(mymap);

</script>

</body>
</html>
